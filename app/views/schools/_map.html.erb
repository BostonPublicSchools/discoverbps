<!-- start google map -->
<div class="wrap global_map">
	
	<section class="content_wrap">
			<%= render partial: 'schools/account_tab' %>		
	</section>
	
	<!-- zone where google map in integrated -->
	<div id='googleMap'></div>
	<!-- END zone where google map in integrated -->
	
	<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDY0kkJiTPVd2U7aTOAwhc9ySH6oHxOIYM&sensor=false"></script>


<!-- script to integrat and personnalize google map for screen (difference with zoom)-->

<script>
function initialize(){

   // Create a new StyledMapType object, passing it the array of styles,
	  // as well as the name to be displayed on the map type control.
	 	var styledMap = new google.maps.StyledMapType(map_styles,{name: "Styled Map"});	
		var myLatlng = 	new google.maps.LatLng(<%= current_student.latitude %>,<%= current_student.longitude %>);
    var latlngbounds = new google.maps.LatLngBounds();
		var mapProp = {
		  center:myLatlng,
		  zoom:13,
			panControl: true,
			zoomControl: false,
			mapTypeControl: false,
			scaleControl: false,
			draggable: false,
			scrollwheel: false,
			streetViewControl: false,
			overviewMapControl: false,
			
			mapTypeControlOptions: {
			  mapTypeIds: [google.maps.MapTypeId.ROADMAP, 'map_style']
			}
		};


		var map = new google.maps.Map(document.getElementById("googleMap"),mapProp);

    var coordinates = new google.maps.LatLng(<%= current_student.latitude %>, <%= current_student.longitude %>);
    latlngbounds.extend(coordinates);
    var marker = new google.maps.Marker({
      position: coordinates,
      icon: {
        path: MAP_HOME,
        fillColor: '#000000',
        fillOpacity: 1,
        strokeColor: '',
        strokeWeight: 0,
        rotation: 180,
        scale: 1/22
      },
      label: '<i class="icon-map-home"></i>',
      map: map
    });
		
    <% schools.each_with_index do |school, i| %>
      <% if school.latitude.present? && school.longitude.present? %>
        var coordinates = new google.maps.LatLng(<%= school.latitude %>, <%= school.longitude %>);
        latlngbounds.extend(coordinates);
        var marker = new google.maps.Marker({
          position: coordinates,
          icon: {
            path: MAP_PIN,
            fillColor: '#f70009',
            fillOpacity: 1,
            strokeColor: '',
            strokeWeight: 0,
            rotation: 180,
            scale: 1/15
          },
          label: '<i class="icon-map-pin"></i>',
          map: map,
          title: '<%= escape_javascript(school.name) %>'
        });
      <% end %>
    <% end %>



		//Associate the styled map with the MapTypeId and set it to display.
		  map.fitBounds(latlngbounds);
      map.mapTypes.set('map_style', styledMap);
		  map.setMapTypeId('map_style');
		
			
	}
		
		
	google.maps.event.addDomListener(window, 'load', initialize);
	</script>
	<!--END script to integrat and personnalize google map-->

</div>
<!-- end google map -->