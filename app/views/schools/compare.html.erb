<%= render partial: 'timeline' %>

	
	<!--  navigation menu desktop and mobile -->
	<section class="content_wrap ">
		<nav class="menu_nav">
            <span id="menu_nav_mobile" aria-hidden="true" class="icon-DBPS-Dev-Assets-SRG-25"></span>
			<ul id="menu_items" class='mobile_only'>
				<li class='first'><a href="#" title="">Discover</a></li>
				<li><a href="#" title="">Register</a></li>
				<li><a href="#" title="">Succeed!</a></li>
				<li class='visit'><a href='http://www.BostonPublicSchools.org'>Visit BostonPublicSchools.org</a></li>
			</ul>
			<ul class='no_mobile'>
				<li class="succeed"><a href="#" title=""><span aria-hidden="true" class="icon-DBPS-Dev-Assets-SRG-05"></span></a></li>
				<li class="register"><a href="#" title=""><span aria-hidden="true" class="icon-DBPS-Dev-Assets-SRG-06"></span></a></li>
			</ul>
		</nav>
		<div class="logo_discover" >
			<span aria-hidden="true" class="icon-DBPS-Dev-Assets-SRG-01"></span>
		</div>
		<div class="clr"></div>
	</section>
	<!-- end navigation menu desktop and mobile -->
	<div class="clr"></div>
</div>

<!-- script for timeline and registration -->
<script>

var is_open_menu_languages_mobile= false;

$(".languages_mobile").click(function() {
		if (is_open_menu_languages_mobile) {
		// Close mobile
		is_open_menu_languages_mobile= false;
		$(".list_languages").css("display", "none");
	 } else {
		// Open mobile
		is_open_menu_languages_mobile= true;
		$(".list_languages").css("display", "block");
	 }
});



var is_open_menu_mobile= false;

$("#menu_nav_mobile").click(function() {

	if (is_open_menu_mobile) {
		// Close mobile
		is_open_menu_mobile= false;
		
		$("#menu_items").animate({
			height: "0"
		  }, 200, function() {
			// Animation complete.
			$(this).css("display", "none");
			$(".menu_nav").width("31px");
			$("#menu_nav_mobile").removeClass( "icon-DBPS-Dev-Assets-SRG-07" ).addClass( " icon-DBPS-Dev-Assets-SRG-25" );
		
		});
	 } else {
		// Open mobile
		$(".menu_nav").width("100%");	
		is_open_menu_mobile= true;
		$("#menu_items").css("display", "block");
		$('#menu_items').css('height', 'auto');
		var autoHeight = $('#menu_items').height();
		$("#menu_items").css("height", "0");
		
		$("#menu_items").animate({
			height: autoHeight
		  }, 200, function() {
			$('#menu_items').css('height', 'auto');
			$("#menu_nav_mobile").removeClass( "icon-DBPS-Dev-Assets-SRG-25" ).addClass( " icon-DBPS-Dev-Assets-SRG-07" );
		});
	 }
});


function initializeRegistrationTimeline() {


	// Ex. (2 1/3) months approximate
	$("#registration_contaner").width(Math.floor((2.333*$(".months .month").outerWidth())));

	
	
	
	// Ex. 2 days approximate
	$("#regis_1").width(2*($(".months .month").outerWidth()/30));

	// Ex. 4 days approximate
	$("#regis_2").width(4*($(".months .month").outerWidth()/30));
	$("#regis_3").width(4*($(".months .month").outerWidth()/30));
	$("#regis_4").width(4*($(".months .month").outerWidth()/30));
	$("#regis_5").width(4*($(".months .month").outerWidth()/30));


	$("#regis_6").width(37*($(".months .month").outerWidth()/30));
	

	var arr= jQuery.makeArray($(".months .month"));
	console.log($($(".months .month")[3]).width());

	
	// Set position registration_contaner on 1 January
	// 3 is position January
	var position = $($(".months .month")[3]).position();
	$("#registration_contaner").css("left",position.left)
}


initializeRegistrationTimeline();

window.onresize = function(event) {
	initializeRegistrationTimeline();
	$("#menu_items").css("display", "none");
	$(".menu_nav").width("auto");
	$("#menu_nav_mobile").removeClass( "icon-DBPS-Dev-Assets-SRG-07" ).addClass( " icon-DBPS-Dev-Assets-SRG-25" );
	is_open_menu_mobile= false;
}

$(".event_zone").hover(
	function() {
		// Position the box in the center of the event.
		$(this).find(".box_info").css("left", -( ($(".box_info").outerWidth()/2) - ($(this).width()/2) )+"px");
		$(this).find(".box_info").css("display", "block");
	},
	function () {
		$(this).find(".box_info").css("display", "none");
		
	}
 );

 /*
var is_open_register_contaner= false;
$("#registration_btn").click(function() {
	 if (is_open_register_contaner) {
		// Close contaner
		is_open_register_contaner= false;
		$(".register_timeline_contaner").css("display", "none");
		$(".wrap.timeline_menu .timeline").stop(true, true).animate({
			height: "80"
		  }, 100, function() {
			// Animation complete.
		  });
	 } else {
		// Open contaner
		$(".wrap.timeline_menu .timeline").stop(true, true).animate({
			height: "175"
		  }, 100, function() {
			// Animation complete.
		  });
		is_open_register_contaner= true;
		$(".register_timeline_contaner").css("display", "block");
	 }
	 
	 return false;
});*/


$(".timeline").hover(
	function() {
		$(".wrap.timeline_menu .timeline").stop(true, true).animate({
			height: "175"
		  }, 100, function() {
			// Animation complete.
		  });
		$(".register_timeline_contaner").css("display", "block");
	}, 
	function() {
		$(".register_timeline_contaner").css("display", "none");
		$(".wrap.timeline_menu .timeline").stop(true, true).animate({
			height: "80"
		  }, 100, function() {
			// Animation complete.
		  });
	}
);
</script>
<!-- END script for timeline and registration -->

<div class="wrap no_mobile">
	<!--languages selection and his list-->
	<ul class='languages'>
		<li>
			<div class='current_language'><span data-icon="&#xe003;" aria-hidden="true"></span>English</div>
			<div class='clr'></div>
			<ul >
				<li><a href='#' class='language'>Español</a></li>
				<li><a href='#' class='language'>Kreyòl Ayisyen</a></li>
				<li><a href='#' class='language'>??</a></li>
				<li><a href='#' class='language'>Português</a></li>
				<li><a href='#' class='language'>Kriolu Kabuverdianu</a></li>
				<li><a href='#' class='language'>Ti?ng Vi?t</a></li>
				<li><a href='#' class='language'>Français</a></li>
				<li><a href='#' class='language'><span data-icon="&#xe003;" aria-hidden="true"></span>Other</a></li>
			</ul>
		</li>
	</ul>
<!--END list-->
</div>

<div class="wrap global_map">
	<section class="content_wrap">
			<%= render partial: 'schools/account_tab' %>		
	</section>
	<%= render partial: 'schools/map', locals: {students_list: @students, map_controls: true} %>
</div>

<div class="wrap compare_list" id="compare_list">
	<div class="colomn_left">
		<div class="menu_compare_name ">
			<div style="width: 170px; height: 42px;">
				<br />
			</div>
			<div class="clr"></div>
		</div>
		<div class="result">
			<div class="compare_list_numbers">
				<ul>
					<% (1..@students.collect {|x| x.student_schools }.max.count).each do |num| %>
						<li><h2><%= num %></h2></li>
					<% end %>
				</ul>
			</div>
		</div>
	</div>	
	<div class="result colomn_right">	
		<div class="compare_list_content">
			<!-- ajust the div width when studens are add (to create left and right draggable effect of the school list)  -->	
			<div class="flexible_content" style="width:1095px;">
				<div class="menu_compare_name compare_action">
					<div class="name_list">
						<% @students.each_with_index do |student, i| %>
							<div class="name_info" id="name_<%= i + 2 %>">
								<span class="name"><%= student.first_name %> <span aria-hidden="true" class="indicator icon-DBPS-Dev-Assets-SRG-08"></span> </span>
								<span class="grade">Grade<br/><span class="number"><%= student.grade_level %></span></span>
								<div class="clr"></div>
							</div>
						<% end %>
					</div>
					<div class="clr"></div>
				</div>
				<% @students.each_with_index do |student, student_i| %>
					<div class="compare_students_column">
						<ul id="sortable_<%= student_i %>">
							<% student.student_schools.rank(:sort_order).each_with_index do |school, i| %>
								<li id="<%= student.id %>_<%= school.bps_id %>">
									<div class="li_frame">
										<div class="school_name draggable line">
											<span class="middle">
						            <h3><%= school.try(:school).try(:api_basic_info).try(:[], 0).try(:[], :schname_23) %></h3>
						          </span>
										</div>
									</div>
								</li>
							<% end %>
						</ul>
					</div>
					<script>
						$(function() {
					    $("#sortable_<%= student_i %>").sortable({ 
					    	axis: "y", 
					    	scroll: true,
					    	update: function(){
						      $.ajax({
						        url: '/schools/sort',
						        type: 'post',
						        data: $('#sortable_<%= student_i %>').sortable('serialize'),
						        dataType: 'script'
						      });
						  	}
						  });
					    $("#sortable_<%= student_i %>").disableSelection();
					  });
					</script>
				<% end %>
				<div class="clr"></div>
			</div>
		</div>
	</div>
	
	<%= render partial: 'schools/footer' %>
	
